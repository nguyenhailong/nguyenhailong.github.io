---
layout: post
title: "R snippet code"
author: long_nguyen
modified:
excerpt: "Collection of small and re-usable source code for R"
tags: []
---
My collection of small and re-usable source code for R.

Feel free to use it if you find it helpful.
# Correlation plot
It could be the first step of your data analytics project. You need to visually pair-wise distribution of your data and how the variables are correlated to each others.
```R
corrgram(data,
         main="Correlation matrix for your data",
         lower.panel=panel.pts, upper.panel=panel.cor,
         diag.panel=panel.density)
```
# Overlay data distributions for comparisons
Given two groups of data, we may need to compare their distributions. Overlay distribution plots will be helpful with beautiful visualization.
```R
# assign two groups for legends
group1$partition = 'group1'
group2$partition = 'group2'
pltData = rbind(group1,group2)
# reset your data
group1$partition = NULL
group2$partition = NULL
for( var in imp_vars){
  xl = paste(var,'\n')
  xl = paste(xl, 'group1: ',round(mean(group1[[var]],na.rm = T),2), '+/-', round(sd(group1[[var]],na.rm = T),2),'\n')
  xl = paste(xl, 'group2: ',round(mean(group2[[var]],na.rm = T),2), '+/-', round(sd(group2[[var]],na.rm = T),2),'\n')
  print(ggplot(pltData, aes(pltData[[var]], fill = partition)) + geom_density(alpha = 0.2) + xlab(xl))
  cat(xl)
  invisible(readline(prompt="Press [enter] to continue"))
}
```
# Histogram of important features vs label
One of my sample code taken from a [Kaggle competition](https://www.kaggle.com/longnguyen/homesite-quote-conversion/histogram-of-important-features-vs-label).

It is very helpful to create 'golden' features. :)
```R
library(readr)
library(ggplot2)
library(ggthemes)
train <- read_csv("../input/train.csv")
#This important list is generated by my model, here I just provide top 10.
important_list = c('PropertyField37','SalesField5','PersonalField9','Field7'
                  ,'PersonalField2','PersonalField1','SalesField4','PersonalField10A'
                  , 'SalesField1B', 'PersonalField10B', 'PersonalField12')
train$QuoteConversion_Flag = as.factor(train$QuoteConversion_Flag)
for( att in important_list){
#Density histogram
plot <- ggplot(train, aes_string(att, fill = 'QuoteConversion_Flag')) +
  geom_histogram(alpha = 0.5, position = 'identity') +
  ggtitle(paste0('Histogram of attribute ', att))
}
```
For example, Field7 at bin value ~25 could be useful for creating an additional variable.

![Histogram of Important Feature](https://lh3.googleusercontent.com/V6k7tLmlQt0wWOtiWJ_1ZN5o4t4VmRtbYC9HAAmmAMkOSkzbY0M2RKTomVIsO_1Otnl-owj17wfwHA2uBasazfe8w2EvO5sFNCoMnUXDtwClhdP_53h9F5DKlYNMXclqi8uGDDAM8Rre64zjzA51M9MFtEemYacxoAuWM17j8IGZB_QP0b5PMY_nD9Cb1NU4q_jwiffclBvixxlqwKy_ETLkTqz9ta0FVb6OTCWoZGppbxRyjKqpMImPpI7464pEHwaJGMQyOkBjoTz7h7gjpWHfe0f5ctlRMe5vQ3KcOWnPpzpPpw6e3xYH8twY7jNOTPMq3v-p6ulJw-hPFYDlTEgSW_F0TFa4ApW1_4Q6N3axNYGjOOdt-CG7kULllMhV4v8BSiqB_rXt-OLn7v4BUQuqT9RMM50GWOrFOdQyCXG369bAkmTeGtGVi46lknPq1_rOq1IP5F62sHcSXcfEWyMbBNcRDmEUXt-Y87rq31jsIySYpVgK19zo9LANtVnsbd5m0LqD4E2gL7kghnjJa9HCY6aSvrRUVOaD5qOU0l9E2M8TwHbn4C3Q5XWVHZ9oFowWafofg-x6Sxg_0rwlfGsikmd-GQ8o3FIfgIlvnlyh7fNO93BDgTBdeJM2bF3bgCL_at6kLnaymGofRIyUNich7zYl6teNjSJE=s840-no "Histogram of Important Feature")

